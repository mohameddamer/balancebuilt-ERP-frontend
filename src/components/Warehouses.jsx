import React,{useEffect,useState} from 'react'; import API,{safeGet} from '../api'; import Toolbar from './Toolbar';
export default function Warehouses(){ const [items,setItems]=useState([]); const [selected,setSelected]=useState(null); const [showForm,setShowForm]=useState(false); const [form,setForm]=useState({code:'',name:''});
  useEffect(()=>safeGet('/api/master/warehouses','warehouses').then(setItems),[]);
  function newItem(){ setForm({code:'',name:''}); setShowForm(true); }
  async function save(){ try{ if(form.id) await API.put(`/api/master/warehouses/${form.id}`, form); else await API.post('/api/master/warehouses', form); setShowForm(false); await safeGet('/api/master/warehouses','warehouses').then(setItems); }catch(e){ alert('Save failed') } }
  return (<div><div className='card'><h3>Warehouses</h3><Toolbar onNew={newItem} onEdit={()=>{}} onDelete={()=>{}} onSearch={q=>API.get('/api/master/warehouses',{params:{q}}).then(r=>setItems(r.data)} filterOptions={[{value:'contains',label:'Contains'}]} /><table className='table'><thead><tr><th>ID</th><th>Code</th><th>Name</th><th>Location</th></tr></thead><tbody>{items.map(w=> <tr key={w.id}><td>{w.id}</td><td>{w.code}</td><td>{w.name}</td><td>{w.location}</td></tr>)}</tbody></table></div>{showForm&&<div className='modal'><h4>{form.id? 'Edit':'New'}</h4><input className='input' placeholder='Code' value={form.code} onChange={e=>setForm({...form,code:e.target.value})}/><input className='input' placeholder='Name' value={form.name} onChange={e=>setForm({...form,name:e.target.value})}/><div style={{display:'flex',gap:8,marginTop:8}}><button className='btn' onClick={save}>Save</button><button className='btn' onClick={()=>setShowForm(false)}>Cancel</button></div></div>}</div>); }
