import React,{useEffect,useState} from 'react'; import API,{safeGet} from '../api'; import Toolbar from './Toolbar';
export default function PurchaseOrders(){ const [items,setItems]=useState([]);
  useEffect(()=>safeGet('/api/procurement/purchase_orders','purchase_orders').then(setItems),[]);
  async function approve(id){ await API.post(`/api/procurement/purchase_orders/${id}/approve`, {approver:'Manager'}); setItems(await safeGet('/api/procurement/purchase_orders','purchase_orders')); }
  return (<div className='card'><h3>Purchase Orders</h3><Toolbar onNew={()=>alert('Create PO via API or CSV upload')} onEdit={()=>{}} onDelete={()=>{}} onSearch={q=>API.get('/api/procurement/purchase_orders',{params:{q}}).then(r=>setItems(r.data))} filterOptions={[{value:'contains',label:'Contains'}]} /><table className='table'><thead><tr><th>ID</th><th>Order #</th><th>Vendor</th><th>Subtotal</th><th>Tax</th><th>Total</th><th>Approval</th><th>Action</th></tr></thead><tbody>{items.map(o=> <tr key={o.id}><td>{o.id}</td><td>{o.order_number}</td><td>{o.vendor_name}</td><td>{o.subtotal}</td><td>{o.tax_amount}</td><td>{o.total_amount}</td><td>{o.approval_status}</td><td>{o.approval_status!=='approved'? <button className='btn' onClick={()=>approve(o.id)}>Approve</button> : 'Approved'}</td></tr>)}</tbody></table></div>); }
